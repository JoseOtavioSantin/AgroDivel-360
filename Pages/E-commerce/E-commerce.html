<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="theme-color" content="#2c2f3f" />
  <title>Dashboard de Pedidos - E-commerce</title>
  <link rel="icon" type="image/png" href="/assets/images/iconeaba.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- LIBS EXTERNAS -->
  <script src="https://unpkg.com/lucide@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/pt.js"></script>

  <!-- CSS -->
  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
  <link rel="stylesheet" href="/assets/css/style.css">
  <link rel="stylesheet" href="/assets/css/Pages/Dashboard/Principal.css">

  <style>
    /* Estilos dos botões de ação */
    .btn-acao {
        display: inline-flex; align-items: center; justify-content: center;
        background-color: #193b7c; color: white; border: none;
        border-radius: 6px; padding: 6px 10px; cursor: pointer;
        transition: background-color 0.2s ease; text-decoration: none;
        margin: 0 2px; font-size: 13px; gap: 6px;
    }
    .btn-acao:hover { background-color: #132a5a; }
    .btn-acao i { width: 16px; height: 16px; pointer-events: none; }

    /* Upload Zone */
    .upload-zone {
      border: 2px dashed #4a5568;
      border-radius: 12px;
      padding: 40px;
      text-align: center;
      background: rgba(255,255,255,0.03);
      transition: all 0.3s ease;
      cursor: pointer;
      margin-bottom: 20px;
    }
    .upload-zone:hover, .upload-zone.dragover {
      border-color: #667eea;
      background: rgba(102, 126, 234, 0.1);
    }
    .upload-zone i { margin-bottom: 10px; color: #718096; }
    .upload-zone h3 { color: #e2e8f0; margin-bottom: 8px; font-size: 16px; }
    .upload-zone p { color: #718096; font-size: 13px; }
    .upload-zone input[type="file"] { display: none; }

    /* Charts Grid */
    .charts-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
      margin-bottom: 20px;
    }
    .chart-card {
      background: #2d3748;
      border-radius: 10px;
      overflow: hidden;
    }
    .chart-header {
      padding: 14px 18px;
      border-bottom: 1px solid #4a5568;
      display: flex; align-items: center; justify-content: space-between;
    }
    .chart-header h3 {
      font-size: 14px; font-weight: 600; color: #e2e8f0;
      display: flex; align-items: center; gap: 8px;
    }
    .chart-body { padding: 16px; height: 280px; position: relative; }

    /* Filters Section */
    .filters-section {
      background: #2d3748;
      border-radius: 10px;
      padding: 16px 20px;
      margin-bottom: 20px;
    }
    .filters-header {
      display: flex; align-items: center; margin-bottom: 14px;
    }
    .filters-header h3 {
      font-size: 14px; font-weight: 600; color: #e2e8f0;
      display: flex; align-items: center; gap: 8px;
    }
    .filters-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 14px;
      align-items: end;
    }
    .filter-group { display: flex; flex-direction: column; gap: 5px; }
    .filter-group label { font-size: 12px; font-weight: 500; color: #a0aec0; }
    .filter-group select, .filter-group input {
      padding: 9px 12px;
      border: 1px solid #4a5568;
      border-radius: 6px;
      font-size: 13px;
      color: #e2e8f0;
      background: #1a202c;
    }
    .filter-group select:focus, .filter-group input:focus {
      outline: none;
      border-color: #667eea;
    }
    .filter-actions { display: flex; gap: 8px; }

    /* Multi-select styles */
    .multi-select-wrapper { position: relative; }
    .multi-select-display {
      padding: 9px 12px;
      border: 1px solid #4a5568;
      border-radius: 6px;
      font-size: 13px;
      color: #e2e8f0;
      background: #1a202c;
      cursor: pointer;
      display: flex; align-items: center; justify-content: space-between;
      min-height: 38px;
    }
    .multi-select-display:hover { border-color: #667eea; }
    .multi-select-dropdown {
      position: absolute;
      top: 100%;
      left: 0; right: 0;
      background: #1a202c;
      border: 1px solid #4a5568;
      border-radius: 6px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      max-height: 220px;
      overflow-y: auto;
      z-index: 100;
      display: none;
    }
    .multi-select-dropdown.active { display: block; }
    .multi-select-option {
      padding: 9px 12px;
      cursor: pointer;
      display: flex; align-items: center; gap: 8px;
      color: #e2e8f0;
      font-size: 13px;
    }
    .multi-select-option:hover { background: #2d3748; }
    .multi-select-option input { accent-color: #667eea; }
    .badge {
      display: inline-flex; align-items: center;
      padding: 2px 8px;
      background: #667eea;
      color: white;
      border-radius: 10px;
      font-size: 11px;
      margin-left: 6px;
    }

    /* Table styles */
    .table-search {
      display: flex; align-items: center; gap: 8px;
    }
    .table-search input {
      padding: 8px 12px;
      border: 1px solid #4a5568;
      border-radius: 6px;
      font-size: 13px;
      background: #1a202c;
      color: #e2e8f0;
      width: 220px;
    }
    .table-search input:focus {
      outline: none;
      border-color: #667eea;
    }
    .table-footer {
      padding: 14px 18px;
      border-top: 1px solid #4a5568;
      display: flex; align-items: center; justify-content: space-between;
    }
    .table-info { font-size: 13px; color: #a0aec0; }
    .pagination { display: flex; gap: 4px; }
    .pagination button {
      width: 32px; height: 32px;
      border: 1px solid #4a5568;
      background: #2d3748;
      border-radius: 6px;
      cursor: pointer;
      font-size: 13px;
      color: #e2e8f0;
      transition: all 0.2s ease;
    }
    .pagination button:hover:not(:disabled) {
      background: #4a5568;
      border-color: #667eea;
    }
    .pagination button.active {
      background: #667eea;
      color: white;
      border-color: #667eea;
    }
    .pagination button:disabled { opacity: 0.5; cursor: not-allowed; }

    /* Modal */
    .modal {
      position: fixed; inset: 0;
      background: rgba(0,0,0,0.7);
      display: flex; align-items: center; justify-content: center;
      z-index: 10000;
      opacity: 0; visibility: hidden;
      transition: all 0.3s ease;
    }
    .modal.active { opacity: 1; visibility: visible; }
    .modal-content {
      background: #2d3748;
      border-radius: 12px;
      max-width: 550px;
      width: 90%;
      max-height: 80vh;
      overflow: hidden;
      transform: scale(0.9);
      transition: transform 0.3s ease;
    }
    .modal.active .modal-content { transform: scale(1); }
    .modal-header {
      padding: 18px 22px;
      border-bottom: 1px solid #4a5568;
      display: flex; align-items: center; justify-content: space-between;
    }
    .modal-header h3 { font-size: 16px; font-weight: 600; color: #e2e8f0; }
    .modal-close {
      width: 32px; height: 32px;
      border: none;
      background: #4a5568;
      border-radius: 6px;
      cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      font-size: 16px;
      color: #e2e8f0;
    }
    .modal-close:hover { background: #667eea; }
    .modal-body { padding: 22px; overflow-y: auto; max-height: 60vh; }
    .detail-row {
      display: flex;
      padding: 10px 0;
      border-bottom: 1px solid #4a5568;
    }
    .detail-row:last-child { border-bottom: none; }
    .detail-label { width: 130px; font-weight: 600; color: #a0aec0; font-size: 13px; }
    .detail-value { flex: 1; color: #e2e8f0; font-size: 13px; }

    /* Loading */
    .loading-overlay {
      position: fixed; inset: 0;
      background: rgba(26, 32, 44, 0.95);
      display: flex; align-items: center; justify-content: center;
      z-index: 9999;
      flex-direction: column;
      gap: 14px;
    }
    .loading-overlay.hidden { display: none; }
    .loading-overlay p { color: #e2e8f0; }
    .spinner {
      width: 44px; height: 44px;
      border: 4px solid #4a5568;
      border-top-color: #667eea;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* Responsive */
    @media (max-width: 1100px) {
      .charts-grid { grid-template-columns: 1fr; }
      .filters-grid { grid-template-columns: repeat(2, 1fr); }
    }
    @media (max-width: 600px) {
      .filters-grid { grid-template-columns: 1fr; }
    }

    /* Top 10 table inside chart */
    .top-table { width: 100%; font-size: 12px; }
    .top-table th {
      text-align: left; padding: 8px 10px;
      background: #1a202c; color: #a0aec0;
      font-weight: 600; font-size: 11px;
    }
    .top-table td { padding: 8px 10px; color: #e2e8f0; border-bottom: 1px solid #4a5568; }
    .top-table tr:hover td { background: #1a202c; }
  </style>

</head>
<body>

  <!-- Loading Overlay -->
  <div id="loadingOverlay" class="loading-overlay hidden">
    <div class="spinner"></div>
    <p>Processando dados...</p>
  </div>

  <!-- Sidebar do sistema -->
  <nav id="sidebar-placeholder"></nav>

  <!-- Conteúdo Principal -->
  <section class="home">
    <div class="text">
      <h1>Dashboard de Pedidos E-commerce</h1>
      <p id="dynamic-title">Importe um arquivo Excel para começar</p>
    </div>

    <!-- CARDS DE RESUMO -->
    <div class="dashboard-cards">
      <div class="dashboard-card pink-card">
        <h2 id="metricTotalPedidos">0</h2>
        <p><i data-lucide="package"></i> Total de Pedidos</p>
      </div>
      <div class="dashboard-card orange-card">
        <h2 id="metricValorTotal">R$ 0,00</h2>
        <p><i data-lucide="dollar-sign"></i> Valor Total</p>
      </div>
      <div class="dashboard-card green-card">
        <h2 id="metricTicketMedio">R$ 0,00</h2>
        <p><i data-lucide="trending-up"></i> Ticket Médio</p>
      </div>
      <div class="dashboard-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
        <h2 id="metricCuponsAtivos">0</h2>
        <p><i data-lucide="tag"></i> Cupons Utilizados</p>
      </div>
    </div>

    <!-- Upload Zone -->
    <div id="uploadZone" class="upload-zone">
      <i data-lucide="cloud-upload" style="width: 48px; height: 48px;"></i>
      <h3>Arraste seu arquivo Excel aqui</h3>
      <p>ou clique para selecionar • Formato suportado: .xlsx, .xls</p>
      <p style="margin-top: 10px; color: #4a5568; font-size: 11px;">
        Arquivo esperado: Order_2026-01-26_1142.xlsx (Planilha "Order" - índice 5)
      </p>
      <input type="file" id="fileUpload" accept=".xlsx,.xls">
    </div>

    <!-- Dashboard Content (hidden until data is loaded) -->
    <div id="dashboardContent" style="display: none;">

      <!-- Filters Section -->
      <div class="filters-section">
        <div class="filters-header">
          <h3><i data-lucide="filter" style="width:16px;height:16px;"></i> Filtros</h3>
        </div>
        <div class="filters-grid">
          <div class="filter-group">
            <label>Cupom</label>
            <div class="multi-select-wrapper" id="filterCupomWrapper">
              <div class="multi-select-display" id="filterCupomDisplay">
                <span>Todos os cupons</span>
                <i data-lucide="chevron-down" style="width:14px;height:14px;"></i>
              </div>
              <div class="multi-select-dropdown" id="filterCupomDropdown"></div>
            </div>
          </div>
          
          <div class="filter-group">
            <label>Loja</label>
            <div class="multi-select-wrapper" id="filterLojaWrapper">
              <div class="multi-select-display" id="filterLojaDisplay">
                <span>Todas as lojas</span>
                <i data-lucide="chevron-down" style="width:14px;height:14px;"></i>
              </div>
              <div class="multi-select-dropdown" id="filterLojaDropdown"></div>
            </div>
          </div>
          
          <div class="filter-group">
            <label>Período</label>
            <input type="text" id="filterDateRange" placeholder="Selecione o período">
          </div>
          
          <div class="filter-group">
            <label>&nbsp;</label>
            <div class="filter-actions">
              <button class="btn-acao" id="btnApplyFilters" style="background:#667eea;">
                <i data-lucide="check" style="width:14px;height:14px;"></i> Aplicar
              </button>
              <button class="btn-acao" id="btnClearFilters" style="background:#4a5568;">
                <i data-lucide="x" style="width:14px;height:14px;"></i> Limpar
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Charts Grid -->
      <div class="charts-grid">
        <div class="chart-card">
          <div class="chart-header">
            <h3><i data-lucide="pie-chart" style="width:16px;height:16px;color:#667eea;"></i> Distribuição por Cupom</h3>
          </div>
          <div class="chart-body">
            <canvas id="chartCupom"></canvas>
          </div>
        </div>
        
        <div class="chart-card">
          <div class="chart-header">
            <h3><i data-lucide="store" style="width:16px;height:16px;color:#48bb78;"></i> Performance por Loja</h3>
          </div>
          <div class="chart-body">
            <canvas id="chartLoja"></canvas>
          </div>
        </div>
        
        <div class="chart-card">
          <div class="chart-header">
            <h3><i data-lucide="trending-up" style="width:16px;height:16px;color:#ed8936;"></i> Evolução Temporal</h3>
          </div>
          <div class="chart-body">
            <canvas id="chartTemporal"></canvas>
          </div>
        </div>
        
        <div class="chart-card">
          <div class="chart-header">
            <h3><i data-lucide="trophy" style="width:16px;height:16px;color:#9f7aea;"></i> Top 10 Clientes</h3>
          </div>
          <div class="chart-body" style="overflow-y: auto; height: 280px;">
            <table class="top-table" id="tableTopClientes">
              <thead>
                <tr>
                  <th>#</th>
                  <th>Cliente</th>
                  <th>Pedidos</th>
                  <th>Valor Total</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Table Section -->
      <div class="content-card">
        <div class="content-card-header">
          <h3>Detalhes dos Pedidos</h3>
          <div class="table-search" style="margin-left:auto;">
            <input type="text" id="tableSearch" placeholder="Buscar pedidos...">
            <button class="btn-acao" id="btnExport" title="Exportar Excel">
              <i data-lucide="download" style="width:16px;height:16px;"></i>
            </button>
          </div>
        </div>
        <div class="content-card-body">
          <table>
            <thead>
              <tr>
                <th data-sort="codigo" style="cursor:pointer;">Nº Pedido</th>
                <th data-sort="data" style="cursor:pointer;">Data</th>
                <th data-sort="cliente" style="cursor:pointer;">Cliente</th>
                <th data-sort="cupom" style="cursor:pointer;">Cupom</th>
                <th data-sort="loja" style="cursor:pointer;">Loja</th>
                <th data-sort="valor" style="cursor:pointer;">Valor</th>
                <th data-sort="vendedor" style="cursor:pointer;">Vendedor</th>
                <th>Ações</th>
              </tr>
            </thead>
            <tbody id="tablePedidos"></tbody>
          </table>
          <div class="table-footer">
            <div class="table-info" id="tableInfo">Mostrando 0 de 0 registros</div>
            <div class="pagination" id="tablePagination"></div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Modal de Detalhes -->
  <div class="modal" id="modalDetalhes">
    <div class="modal-content">
      <div class="modal-header">
        <h3><i data-lucide="file-text" style="width:18px;height:18px;"></i> Detalhes do Pedido</h3>
        <button class="modal-close" onclick="closeModal()">&times;</button>
      </div>
      <div class="modal-body" id="modalBody"></div>
    </div>
  </div>

  <script>
    // ========== GLOBAL VARIABLES ==========
    let allData = [];
    let filteredData = [];
    let currentPage = 1;
    const itemsPerPage = 10;
    let sortColumn = 'data';
    let sortDirection = 'desc';
    
    // Chart instances
    let chartCupom = null;
    let chartLoja = null;
    let chartTemporal = null;
    
    // Filter states
    let selectedCupons = [];
    let selectedLojas = [];
    let dateRange = null;
    
    // Flatpickr instance
    let datePickerInstance = null;

    // ========== INITIALIZATION ==========
    document.addEventListener('DOMContentLoaded', function() {
      initializeApp();
      lucide.createIcons();
    });

    function initializeApp() {
      setupFileUpload();
      setupFilters();
      setupTableSorting();
      setupSearch();
      setupExport();
      initDatePicker();
    }

    // ========== FILE UPLOAD ==========
    function setupFileUpload() {
      const fileInput = document.getElementById('fileUpload');
      const uploadZone = document.getElementById('uploadZone');
      
      fileInput.addEventListener('change', handleFileSelect);
      uploadZone.addEventListener('click', () => fileInput.click());
      
      uploadZone.addEventListener('dragover', (e) => {
        e.preventDefault();
        uploadZone.classList.add('dragover');
      });
      
      uploadZone.addEventListener('dragleave', () => {
        uploadZone.classList.remove('dragover');
      });
      
      uploadZone.addEventListener('drop', (e) => {
        e.preventDefault();
        uploadZone.classList.remove('dragover');
        const files = e.dataTransfer.files;
        if (files.length > 0) processFile(files[0]);
      });
    }

    function handleFileSelect(e) {
      const file = e.target.files[0];
      if (file) processFile(file);
    }

    function processFile(file) {
      const validTypes = ['application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', 'application/vnd.ms-excel'];
      if (!validTypes.includes(file.type) && !file.name.match(/\.(xlsx|xls)$/i)) {
        Swal.fire({ icon: 'error', title: 'Arquivo inválido', text: 'Por favor, selecione um arquivo Excel (.xlsx ou .xls)' });
        return;
      }
      
      showLoading();
      
      const reader = new FileReader();
      reader.onload = function(e) {
        try {
          const data = new Uint8Array(e.target.result);
          const workbook = XLSX.read(data, { type: 'array', cellDates: true });
          
          let sheetName = workbook.SheetNames[5] || workbook.SheetNames.find(name => 
            name.toLowerCase().includes('order') || name.toLowerCase().includes('pedido')
          ) || workbook.SheetNames[0];
          
          console.log('Planilhas disponíveis:', workbook.SheetNames);
          console.log('Planilha selecionada:', sheetName);
          
          const worksheet = workbook.Sheets[sheetName];
          const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, raw: false, dateNF: 'dd/mm/yyyy' });
          
          processExcelData(jsonData);
          
        } catch (error) {
          console.error('Erro ao processar:', error);
          hideLoading();
          Swal.fire({ icon: 'error', title: 'Erro ao processar', text: 'Verifique se o formato está correto.' });
        }
      };
      
      reader.onerror = function() {
        hideLoading();
        Swal.fire({ icon: 'error', title: 'Erro ao ler arquivo' });
      };
      
      reader.readAsArrayBuffer(file);
    }

    function processExcelData(jsonData) {
      let headerRowIndex = 0;
      for (let i = 0; i < Math.min(10, jsonData.length); i++) {
        const row = jsonData[i];
        if (row && row.some(cell => 
          (typeof cell === 'string') && 
          (cell.toLowerCase().includes('cliente') || 
           cell.toLowerCase().includes('pedido') ||
           cell.toLowerCase().includes('preço total'))
        )) {
          headerRowIndex = i;
          break;
        }
      }
      
      const headers = jsonData[headerRowIndex];
      console.log('Headers encontrados:', headers);
      
      // Colunas obrigatórias do E-commerce (nomes exatos da planilha)
      const colunasObrigatorias = [
        { nome: 'Clientes*', keywords: ['clientes*', 'clientes'] },
        { nome: 'Códigos de cupom aplicados+', keywords: ['códigos de cupom aplicados', 'cupom aplicado', 'códigos de cupom'] },
        { nome: 'Data*', keywords: ['data*', 'data'] },
        { nome: 'Local de Retirada', keywords: ['local de retirada', 'local retirada'] },
        { nome: 'Nº do pedido.^', keywords: ['nº do pedido', 'n° do pedido', 'numero do pedido', 'nº pedido'] },
        { nome: 'Preço total', keywords: ['preço total', 'preco total'] },
        { nome: 'Vendedora', keywords: ['vendedora', 'vendedor'] }
      ];
      
      // Validar se as colunas obrigatórias existem
      const colunasEncontradas = [];
      const colunasFaltando = [];
      
      for (const coluna of colunasObrigatorias) {
        const index = findColumnIndex(headers, coluna.keywords);
        if (index !== -1) {
          colunasEncontradas.push(coluna.nome);
        } else {
          colunasFaltando.push(coluna.nome);
        }
      }
      
      console.log('Colunas encontradas:', colunasEncontradas);
      console.log('Colunas faltando:', colunasFaltando);
      
      // Se faltam mais de 3 colunas obrigatórias, rejeitar o arquivo
      if (colunasFaltando.length > 3) {
        hideLoading();
        Swal.fire({ 
          icon: 'error', 
          title: 'Arquivo incompatível', 
          html: `<p>Este arquivo não parece ser uma planilha de pedidos do E-commerce.</p>
                 <p style="margin-top:10px;font-size:13px;color:#a0aec0;">Colunas esperadas que não foram encontradas:</p>
                 <ul style="text-align:left;font-size:12px;color:#e2e8f0;margin-top:5px;">
                   ${colunasFaltando.map(c => `<li>${c}</li>`).join('')}
                 </ul>`,
          confirmButtonText: 'Entendi'
        });
        return;
      }
      
      // Mapear colunas encontradas
      const columnMap = {
        cliente: findColumnIndex(headers, ['clientes*', 'clientes', 'cliente', 'email', 'customer']),
        cupom: findColumnIndex(headers, ['códigos de cupom aplicados', 'cupom aplicado', 'códigos de cupom', 'cupom']),
        data: findColumnIndex(headers, ['data*', 'data', 'date']),
        loja: findColumnIndex(headers, ['local de retirada', 'local retirada', 'loja', 'filial']),
        codigo: findColumnIndex(headers, ['nº do pedido', 'n° do pedido', 'numero do pedido', 'nº pedido', 'pedido']),
        valor: findColumnIndex(headers, ['preço total', 'preco total', 'total', 'valor', 'price', 'amount']),
        vendedor: findColumnIndex(headers, ['vendedora', 'vendedor', 'seller', 'atendente'])
      };
      
      console.log('Mapeamento de colunas:', columnMap);
      
      // Se não encontrou "Preço total", rejeitar
      if (columnMap.valor === -1) {
        hideLoading();
        Swal.fire({ 
          icon: 'error', 
          title: 'Coluna "Preço total" não encontrada', 
          text: 'O arquivo deve conter a coluna "Preço total" para calcular os valores.',
          confirmButtonText: 'Entendi'
        });
        return;
      }
      
      allData = [];
      for (let i = headerRowIndex + 1; i < jsonData.length; i++) {
        const row = jsonData[i];
        if (!row || row.length === 0) continue;
        
        const codigo = cleanValue(row[columnMap.codigo]);
        const cliente = cleanValue(row[columnMap.cliente]);
        const valorRaw = row[columnMap.valor];
        
        // Pular linhas vazias
        if (!codigo && !cliente) continue;
        
        const valorParsed = parseValue(valorRaw);
        console.log(`Linha ${i}: Valor raw = "${valorRaw}" | Valor parsed = ${valorParsed}`);
        
        allData.push({
          cliente: cliente || 'N/A',
          cupom: cleanValue(row[columnMap.cupom]) || 'Sem cupom',
          data: parseDate(row[columnMap.data]),
          loja: cleanValue(row[columnMap.loja]) || 'N/A',
          codigo: codigo || 'N/A',
          valor: valorParsed,
          vendedor: cleanValue(row[columnMap.vendedor]) || 'N/A',
          raw: row
        });
      }
      
      console.log('Registros processados:', allData.length);
      console.log('Exemplo de dados:', allData.slice(0, 3));
      
      if (allData.length === 0) {
        hideLoading();
        Swal.fire({ icon: 'warning', title: 'Nenhum dado encontrado', text: 'Verifique o formato do arquivo.' });
        return;
      }
      
      filteredData = [...allData];
      populateFilters();
      updateDashboard();
      
      document.getElementById('uploadZone').style.display = 'none';
      document.getElementById('dashboardContent').style.display = 'block';
      document.getElementById('dynamic-title').textContent = `${allData.length} pedidos carregados`;
      
      hideLoading();
      lucide.createIcons();
      
      Swal.fire({
        icon: 'success',
        title: 'Dados importados!',
        text: `${allData.length} pedidos carregados com sucesso.`,
        toast: true,
        position: 'top-end',
        showConfirmButton: false,
        timer: 3000
      });
    }

    // Função para normalizar texto (remove acentos e caracteres especiais)
    function normalizeText(text) {
      return (text || '').toString().toLowerCase()
        .normalize('NFD').replace(/[\u0300-\u036f]/g, '') // Remove acentos
        .replace(/[^a-z0-9\s]/g, '') // Remove caracteres especiais
        .trim();
    }

    function findColumnIndex(headers, keywords) {
      if (!headers) return -1;
      for (let i = 0; i < headers.length; i++) {
        const headerNormalized = normalizeText(headers[i]);
        const headerOriginal = (headers[i] || '').toString().toLowerCase().trim();
        
        for (const keyword of keywords) {
          const keywordNormalized = normalizeText(keyword);
          const keywordOriginal = keyword.toLowerCase().trim();
          
          // Tenta match com texto normalizado (sem acentos) e original
          if (headerNormalized.includes(keywordNormalized) || 
              headerOriginal.includes(keywordOriginal)) {
            console.log(`Coluna encontrada: "${headers[i]}" para keyword "${keyword}" na posição ${i}`);
            return i;
          }
        }
      }
      return -1;
    }

    function cleanValue(value) {
      if (value === null || value === undefined) return '';
      return String(value).trim();
    }

    function parseDate(value) {
      if (!value) return null;
      if (value instanceof Date) return value;
      
      const str = String(value).trim();
      let match = str.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);
      if (match) return new Date(match[3], match[2] - 1, match[1]);
      
      match = str.match(/^(\d{4})-(\d{2})-(\d{2})/);
      if (match) return new Date(match[1], match[2] - 1, match[3]);
      
      const parsed = new Date(value);
      if (!isNaN(parsed.getTime())) return parsed;
      
      return null;
    }

    function parseValue(value) {
      if (!value) return 0;
      
      // Se já é um número, retorna diretamente
      if (typeof value === 'number') return value;
      
      let str = String(value).trim();
      
      // Remove símbolo de moeda e espaços
      str = str.replace(/[R$\s]/g, '');
      
      // Detecta formato brasileiro (1.234,56) vs americano (1,234.56)
      if (str.includes(',') && str.includes('.')) {
        const lastComma = str.lastIndexOf(',');
        const lastDot = str.lastIndexOf('.');
        
        if (lastComma > lastDot) {
          // Formato brasileiro: 1.234,56
          str = str.replace(/\./g, '').replace(',', '.');
        } else {
          // Formato americano: 1,234.56
          str = str.replace(/,/g, '');
        }
      } else if (str.includes(',')) {
        // Só tem vírgula - assume decimal brasileiro
        str = str.replace(',', '.');
      }
      
      const num = parseFloat(str);
      return isNaN(num) ? 0 : num;
    }

    // ========== FILTERS ==========
    function setupFilters() {
      setupMultiSelect('filterCupomWrapper', 'filterCupomDisplay', 'filterCupomDropdown', 'cupom');
      setupMultiSelect('filterLojaWrapper', 'filterLojaDisplay', 'filterLojaDropdown', 'loja');
      document.getElementById('btnApplyFilters').addEventListener('click', applyFilters);
      document.getElementById('btnClearFilters').addEventListener('click', clearFilters);
    }

    function setupMultiSelect(wrapperId, displayId, dropdownId, type) {
      const display = document.getElementById(displayId);
      const dropdown = document.getElementById(dropdownId);
      
      display.addEventListener('click', (e) => {
        e.stopPropagation();
        dropdown.classList.toggle('active');
        document.querySelectorAll('.multi-select-dropdown').forEach(d => {
          if (d !== dropdown) d.classList.remove('active');
        });
      });
      
      document.addEventListener('click', () => dropdown.classList.remove('active'));
      dropdown.addEventListener('click', (e) => e.stopPropagation());
    }

    function populateFilters() {
      const cupons = [...new Set(allData.map(item => item.cupom))].sort();
      const lojas = [...new Set(allData.map(item => item.loja))].sort();
      
      const cupomDropdown = document.getElementById('filterCupomDropdown');
      cupomDropdown.innerHTML = cupons.map(cupom => `
        <label class="multi-select-option">
          <input type="checkbox" value="${escapeHtml(cupom)}" onchange="updateCupomSelection()">
          ${escapeHtml(cupom)}
        </label>
      `).join('');
      
      const lojaDropdown = document.getElementById('filterLojaDropdown');
      lojaDropdown.innerHTML = lojas.map(loja => `
        <label class="multi-select-option">
          <input type="checkbox" value="${escapeHtml(loja)}" onchange="updateLojaSelection()">
          ${escapeHtml(loja)}
        </label>
      `).join('');
      
      selectedCupons = [];
      selectedLojas = [];
      updateFilterDisplays();
      
      if (datePickerInstance) {
        const dates = allData.filter(d => d.data).map(d => d.data);
        if (dates.length > 0) {
          datePickerInstance.set('minDate', new Date(Math.min(...dates)));
          datePickerInstance.set('maxDate', new Date(Math.max(...dates)));
        }
      }
    }

    function updateCupomSelection() {
      selectedCupons = [];
      document.querySelectorAll('#filterCupomDropdown input:checked').forEach(input => {
        selectedCupons.push(input.value);
      });
      updateFilterDisplays();
    }

    function updateLojaSelection() {
      selectedLojas = [];
      document.querySelectorAll('#filterLojaDropdown input:checked').forEach(input => {
        selectedLojas.push(input.value);
      });
      updateFilterDisplays();
    }

    function updateFilterDisplays() {
      const cupomDisplay = document.getElementById('filterCupomDisplay');
      if (selectedCupons.length === 0) {
        cupomDisplay.innerHTML = '<span>Todos os cupons</span><i data-lucide="chevron-down" style="width:14px;height:14px;"></i>';
      } else {
        cupomDisplay.innerHTML = `<span>${selectedCupons.length} selecionado(s)</span><span class="badge">${selectedCupons.length}</span><i data-lucide="chevron-down" style="width:14px;height:14px;"></i>`;
      }
      
      const lojaDisplay = document.getElementById('filterLojaDisplay');
      if (selectedLojas.length === 0) {
        lojaDisplay.innerHTML = '<span>Todas as lojas</span><i data-lucide="chevron-down" style="width:14px;height:14px;"></i>';
      } else {
        lojaDisplay.innerHTML = `<span>${selectedLojas.length} selecionada(s)</span><span class="badge">${selectedLojas.length}</span><i data-lucide="chevron-down" style="width:14px;height:14px;"></i>`;
      }
      lucide.createIcons();
    }

    function initDatePicker() {
      datePickerInstance = flatpickr('#filterDateRange', {
        mode: 'range',
        dateFormat: 'd/m/Y',
        locale: 'pt',
        onChange: function(selectedDates) {
          dateRange = selectedDates.length === 2 ? selectedDates : null;
        }
      });
    }

    function applyFilters() {
      filteredData = allData.filter(item => {
        if (selectedCupons.length > 0 && !selectedCupons.includes(item.cupom)) return false;
        if (selectedLojas.length > 0 && !selectedLojas.includes(item.loja)) return false;
        
        if (dateRange && dateRange.length === 2) {
          if (!item.data) return false;
          const itemDate = new Date(item.data);
          itemDate.setHours(0, 0, 0, 0);
          const startDate = new Date(dateRange[0]);
          startDate.setHours(0, 0, 0, 0);
          const endDate = new Date(dateRange[1]);
          endDate.setHours(23, 59, 59, 999);
          if (itemDate < startDate || itemDate > endDate) return false;
        }
        return true;
      });
      
      currentPage = 1;
      updateDashboard();
    }

    function clearFilters() {
      document.querySelectorAll('#filterCupomDropdown input, #filterLojaDropdown input').forEach(input => {
        input.checked = false;
      });
      selectedCupons = [];
      selectedLojas = [];
      dateRange = null;
      if (datePickerInstance) datePickerInstance.clear();
      updateFilterDisplays();
      filteredData = [...allData];
      currentPage = 1;
      updateDashboard();
    }

    // ========== DASHBOARD UPDATE ==========
    function updateDashboard() {
      updateMetrics();
      updateCharts();
      updateTable();
    }

    function updateMetrics() {
      const totalPedidos = filteredData.length;
      document.getElementById('metricTotalPedidos').textContent = totalPedidos.toLocaleString('pt-BR');
      
      const valorTotal = filteredData.reduce((sum, item) => sum + item.valor, 0);
      document.getElementById('metricValorTotal').textContent = formatCurrency(valorTotal);
      
      const ticketMedio = totalPedidos > 0 ? valorTotal / totalPedidos : 0;
      document.getElementById('metricTicketMedio').textContent = formatCurrency(ticketMedio);
      
      const cuponsUnicos = [...new Set(filteredData.map(item => item.cupom).filter(c => c && c !== 'Sem cupom'))];
      document.getElementById('metricCuponsAtivos').textContent = cuponsUnicos.length;
    }

    function updateCharts() {
      updateChartCupom();
      updateChartLoja();
      updateChartTemporal();
      updateTopClientes();
    }

    function updateChartCupom() {
      const ctx = document.getElementById('chartCupom').getContext('2d');
      if (chartCupom) chartCupom.destroy();
      
      const cupomCount = {};
      filteredData.forEach(item => {
        const cupom = item.cupom || 'Sem cupom';
        cupomCount[cupom] = (cupomCount[cupom] || 0) + 1;
      });
      
      const labels = Object.keys(cupomCount);
      const data = Object.values(cupomCount);
      const total = data.reduce((a, b) => a + b, 0);
      const colors = generateColors(labels.length);
      
      chartCupom = new Chart(ctx, {
        type: 'doughnut',
        data: {
          labels: labels,
          datasets: [{ data: data, backgroundColor: colors, borderWidth: 0 }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { position: 'right', labels: { boxWidth: 12, padding: 10, font: { size: 11 }, color: '#a0aec0' } },
            tooltip: {
              callbacks: {
                label: function(context) {
                  const percentage = ((context.parsed / total) * 100).toFixed(1);
                  return `${context.label}: ${context.parsed} pedidos (${percentage}%)`;
                }
              }
            }
          }
        }
      });
    }

    function updateChartLoja() {
      const ctx = document.getElementById('chartLoja').getContext('2d');
      if (chartLoja) chartLoja.destroy();
      
      const lojaValor = {};
      filteredData.forEach(item => {
        const loja = item.loja || 'N/A';
        lojaValor[loja] = (lojaValor[loja] || 0) + item.valor;
      });
      
      const sorted = Object.entries(lojaValor).sort((a, b) => b[1] - a[1]);
      const labels = sorted.map(item => item[0]);
      const data = sorted.map(item => item[1]);
      
      chartLoja = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [{ label: 'Valor Total', data: data, backgroundColor: '#48bb78', borderRadius: 4 }]
        },
        options: {
          indexAxis: 'y',
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false },
            tooltip: { callbacks: { label: (ctx) => formatCurrency(ctx.parsed.x) } }
          },
          scales: {
            x: { beginAtZero: true, ticks: { callback: (v) => formatCurrency(v, true), color: '#a0aec0' }, grid: { color: '#4a5568' } },
            y: { ticks: { font: { size: 11 }, color: '#a0aec0' }, grid: { display: false } }
          }
        }
      });
    }

    function updateChartTemporal() {
      const ctx = document.getElementById('chartTemporal').getContext('2d');
      if (chartTemporal) chartTemporal.destroy();
      
      const dateCount = {};
      filteredData.forEach(item => {
        if (item.data) {
          const dateKey = formatDateKey(item.data);
          dateCount[dateKey] = (dateCount[dateKey] || 0) + 1;
        }
      });
      
      const sortedDates = Object.keys(dateCount).sort((a, b) => parseDateKey(a) - parseDateKey(b));
      const data = sortedDates.map(date => dateCount[date]);
      
      chartTemporal = new Chart(ctx, {
        type: 'line',
        data: {
          labels: sortedDates,
          datasets: [{
            label: 'Pedidos',
            data: data,
            borderColor: '#ed8936',
            backgroundColor: 'rgba(237, 137, 54, 0.1)',
            fill: true,
            tension: 0.4,
            pointBackgroundColor: '#ed8936',
            pointBorderColor: '#1a202c',
            pointBorderWidth: 2,
            pointRadius: 4
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { display: false } },
          scales: {
            x: { ticks: { maxTicksLimit: 10, font: { size: 11 }, color: '#a0aec0' }, grid: { color: '#4a5568' } },
            y: { beginAtZero: true, ticks: { stepSize: 1, color: '#a0aec0' }, grid: { color: '#4a5568' } }
          }
        }
      });
    }

    function updateTopClientes() {
      const clienteData = {};
      filteredData.forEach(item => {
        const cliente = item.cliente || 'N/A';
        if (!clienteData[cliente]) clienteData[cliente] = { pedidos: 0, valor: 0 };
        clienteData[cliente].pedidos++;
        clienteData[cliente].valor += item.valor;
      });
      
      const sorted = Object.entries(clienteData).sort((a, b) => b[1].valor - a[1].valor).slice(0, 10);
      
      const tbody = document.querySelector('#tableTopClientes tbody');
      tbody.innerHTML = sorted.map((item, index) => `
        <tr>
          <td>${index + 1}</td>
          <td title="${escapeHtml(item[0])}">${truncateText(item[0], 25)}</td>
          <td>${item[1].pedidos}</td>
          <td>${formatCurrency(item[1].valor)}</td>
        </tr>
      `).join('');
    }

    // ========== TABLE ==========
    function setupTableSorting() {
      document.querySelectorAll('th[data-sort]').forEach(th => {
        th.addEventListener('click', () => {
          const column = th.dataset.sort;
          if (sortColumn === column) {
            sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
          } else {
            sortColumn = column;
            sortDirection = 'asc';
          }
          updateTable();
        });
      });
    }

    function updateTable() {
      const sortedData = [...filteredData].sort((a, b) => {
        let valA = a[sortColumn];
        let valB = b[sortColumn];
        
        if (sortColumn === 'data') {
          valA = valA ? new Date(valA).getTime() : 0;
          valB = valB ? new Date(valB).getTime() : 0;
        } else if (sortColumn === 'valor') {
          valA = valA || 0;
          valB = valB || 0;
        } else {
          valA = (valA || '').toString().toLowerCase();
          valB = (valB || '').toString().toLowerCase();
        }
        
        if (valA < valB) return sortDirection === 'asc' ? -1 : 1;
        if (valA > valB) return sortDirection === 'asc' ? 1 : -1;
        return 0;
      });
      
      const totalPages = Math.ceil(sortedData.length / itemsPerPage);
      const startIndex = (currentPage - 1) * itemsPerPage;
      const pageData = sortedData.slice(startIndex, startIndex + itemsPerPage);
      
      const tbody = document.getElementById('tablePedidos');
      tbody.innerHTML = pageData.map((item, index) => `
        <tr>
          <td>${escapeHtml(item.codigo)}</td>
          <td>${item.data ? formatDate(item.data) : 'N/A'}</td>
          <td title="${escapeHtml(item.cliente)}">${truncateText(item.cliente, 25)}</td>
          <td>${escapeHtml(item.cupom)}</td>
          <td>${escapeHtml(item.loja)}</td>
          <td>${formatCurrency(item.valor)}</td>
          <td>${escapeHtml(item.vendedor)}</td>
          <td>
            <button class="btn-acao" onclick="showDetails(${startIndex + index})" title="Ver Detalhes">
              <i data-lucide="eye" style="width:14px;height:14px;"></i>
            </button>
          </td>
        </tr>
      `).join('');
      
      document.getElementById('tableInfo').textContent = 
        `Mostrando ${startIndex + 1}-${Math.min(startIndex + itemsPerPage, sortedData.length)} de ${sortedData.length} registros`;
      
      updatePagination(totalPages);
      lucide.createIcons();
    }

    function updatePagination(totalPages) {
      const pagination = document.getElementById('tablePagination');
      let html = '';
      
      html += `<button ${currentPage === 1 ? 'disabled' : ''} onclick="goToPage(${currentPage - 1})"><i data-lucide="chevron-left" style="width:14px;height:14px;"></i></button>`;
      
      const maxVisible = 5;
      let startPage = Math.max(1, currentPage - Math.floor(maxVisible / 2));
      let endPage = Math.min(totalPages, startPage + maxVisible - 1);
      if (endPage - startPage + 1 < maxVisible) startPage = Math.max(1, endPage - maxVisible + 1);
      
      if (startPage > 1) {
        html += `<button onclick="goToPage(1)">1</button>`;
        if (startPage > 2) html += `<button disabled>...</button>`;
      }
      
      for (let i = startPage; i <= endPage; i++) {
        html += `<button class="${i === currentPage ? 'active' : ''}" onclick="goToPage(${i})">${i}</button>`;
      }
      
      if (endPage < totalPages) {
        if (endPage < totalPages - 1) html += `<button disabled>...</button>`;
        html += `<button onclick="goToPage(${totalPages})">${totalPages}</button>`;
      }
      
      html += `<button ${currentPage === totalPages || totalPages === 0 ? 'disabled' : ''} onclick="goToPage(${currentPage + 1})"><i data-lucide="chevron-right" style="width:14px;height:14px;"></i></button>`;
      
      pagination.innerHTML = html;
      lucide.createIcons();
    }

    function goToPage(page) {
      currentPage = page;
      updateTable();
    }

    // ========== SEARCH ==========
    function setupSearch() {
      const searchInput = document.getElementById('tableSearch');
      searchInput.addEventListener('keyup', (e) => {
        if (e.key === 'Enter') performSearch();
      });
      searchInput.addEventListener('input', performSearch);
    }

    function performSearch() {
      const query = document.getElementById('tableSearch').value.toLowerCase().trim();
      
      if (!query) {
        filteredData = applyCurrentFilters(allData);
      } else {
        filteredData = applyCurrentFilters(allData).filter(item => {
          return item.codigo.toLowerCase().includes(query) ||
                 item.cliente.toLowerCase().includes(query) ||
                 item.cupom.toLowerCase().includes(query) ||
                 item.loja.toLowerCase().includes(query) ||
                 item.vendedor.toLowerCase().includes(query);
        });
      }
      
      currentPage = 1;
      updateDashboard();
    }

    function applyCurrentFilters(data) {
      return data.filter(item => {
        if (selectedCupons.length > 0 && !selectedCupons.includes(item.cupom)) return false;
        if (selectedLojas.length > 0 && !selectedLojas.includes(item.loja)) return false;
        if (dateRange && dateRange.length === 2) {
          if (!item.data) return false;
          const itemDate = new Date(item.data);
          itemDate.setHours(0, 0, 0, 0);
          const startDate = new Date(dateRange[0]);
          startDate.setHours(0, 0, 0, 0);
          const endDate = new Date(dateRange[1]);
          endDate.setHours(23, 59, 59, 999);
          if (itemDate < startDate || itemDate > endDate) return false;
        }
        return true;
      });
    }

    // ========== EXPORT ==========
    function setupExport() {
      document.getElementById('btnExport').addEventListener('click', exportData);
    }

    function exportData() {
      if (filteredData.length === 0) {
        Swal.fire({ icon: 'warning', title: 'Sem dados', text: 'Não há dados para exportar.' });
        return;
      }
      
      const exportData = filteredData.map(item => ({
        'Nº Pedido': item.codigo,
        'Data': item.data ? formatDate(item.data) : '',
        'Cliente': item.cliente,
        'Cupom': item.cupom,
        'Loja': item.loja,
        'Valor': item.valor,
        'Vendedor': item.vendedor
      }));
      
      const ws = XLSX.utils.json_to_sheet(exportData);
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, 'Pedidos');
      
      const date = new Date().toISOString().slice(0, 10);
      XLSX.writeFile(wb, `pedidos_export_${date}.xlsx`);
      
      Swal.fire({ icon: 'success', title: 'Exportado!', toast: true, position: 'top-end', showConfirmButton: false, timer: 2500 });
    }

    // ========== MODAL ==========
    function showDetails(index) {
      const item = filteredData[index];
      if (!item) return;
      
      document.getElementById('modalBody').innerHTML = `
        <div class="detail-row"><span class="detail-label">Nº Pedido</span><span class="detail-value">${escapeHtml(item.codigo)}</span></div>
        <div class="detail-row"><span class="detail-label">Data</span><span class="detail-value">${item.data ? formatDate(item.data) : 'N/A'}</span></div>
        <div class="detail-row"><span class="detail-label">Cliente</span><span class="detail-value">${escapeHtml(item.cliente)}</span></div>
        <div class="detail-row"><span class="detail-label">Cupom</span><span class="detail-value">${escapeHtml(item.cupom)}</span></div>
        <div class="detail-row"><span class="detail-label">Loja</span><span class="detail-value">${escapeHtml(item.loja)}</span></div>
        <div class="detail-row"><span class="detail-label">Valor</span><span class="detail-value" style="font-weight:600;color:#48bb78;">${formatCurrency(item.valor)}</span></div>
        <div class="detail-row"><span class="detail-label">Vendedor</span><span class="detail-value">${escapeHtml(item.vendedor)}</span></div>
      `;
      
      document.getElementById('modalDetalhes').classList.add('active');
      lucide.createIcons();
    }

    function closeModal() {
      document.getElementById('modalDetalhes').classList.remove('active');
    }

    document.getElementById('modalDetalhes').addEventListener('click', (e) => {
      if (e.target.id === 'modalDetalhes') closeModal();
    });
    document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeModal(); });

    // ========== UTILITY FUNCTIONS ==========
    function formatCurrency(value, compact = false) {
      if (compact && value >= 1000) return 'R$ ' + (value / 1000).toFixed(1) + 'k';
      return value.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
    }

    function formatDate(date) {
      if (!date) return '';
      return new Date(date).toLocaleDateString('pt-BR');
    }

    function formatDateKey(date) {
      const d = new Date(date);
      return `${d.getDate().toString().padStart(2, '0')}/${(d.getMonth() + 1).toString().padStart(2, '0')}`;
    }

    function parseDateKey(dateStr) {
      const [day, month] = dateStr.split('/');
      return new Date(2026, parseInt(month) - 1, parseInt(day));
    }

    function escapeHtml(text) {
      if (!text) return '';
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    function truncateText(text, maxLength) {
      if (!text) return '';
      if (text.length <= maxLength) return escapeHtml(text);
      return escapeHtml(text.substring(0, maxLength)) + '...';
    }

    function generateColors(count) {
      const baseColors = ['#667eea', '#48bb78', '#ed8936', '#f56565', '#9f7aea', '#38b2ac', '#ed64a6', '#4fd1c5', '#fc8181', '#68d391', '#a78bfa', '#fbbf24'];
      const colors = [];
      for (let i = 0; i < count; i++) colors.push(baseColors[i % baseColors.length]);
      return colors;
    }

    function showLoading() { document.getElementById('loadingOverlay').classList.remove('hidden'); }
    function hideLoading() { document.getElementById('loadingOverlay').classList.add('hidden'); }
  </script>

  <!-- Scripts Globais -->
  <script type="module" src="/assets/js/firebase-config.js"></script>
  <script type="module" src="/assets/js/auth.js"></script>
  <script src="/assets/js/main.js"></script>
  <script src="/assets/js/components/Sidebar.js"></script>

</body>
</html>
