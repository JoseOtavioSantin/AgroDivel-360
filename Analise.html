<label>Nome do Cliente</label>
<input type="text" id="cliente">

<label>Modelo do Equipamento</label>
<input type="text" id="modelo">

<label>Anexar Relatório Excel</label>
<input type="file" id="fileInput">

<button onclick="enviar()">Gerar Relatório PDF</button>

<script>
async function enviar() {
  const cliente = document.getElementById("cliente").value;
  const modelo = document.getElementById("modelo").value;
  const file = document.getElementById("fileInput").files[0];

  const formData = new FormData();
  formData.append("cliente", cliente);
  formData.append("modelo", modelo);
  formData.append("relatorio", file);

  const resp = await fetch("/api/analisar", { // rota interna do Vercel
    method: "POST",
    body: formData
  });

  const blob = await resp.blob();
  const url = window.URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "relatorio.pdf";
  document.body.appendChild(a);
  a.click();
  a.remove();
}
</script>
