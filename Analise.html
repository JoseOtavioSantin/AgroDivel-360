<!-- campos -->
<label for="cliente">Nome do Cliente</label>
<input type="text" id="cliente" name="cliente">

<label for="modelo">Modelo do Equipamento</label>
<input type="text" id="modelo" name="modelo">

<label for="fileInput">Anexar Relatório Excel</label>
<input type="file" id="fileInput" name="relatorio" accept=".xlsx">
<button onclick="enviar()">Gerar Relatório PDF</button>

<script>
async function enviar() {
  const cliente = document.getElementById("cliente").value;
  const modelo  = document.getElementById("modelo").value;
  const file    = document.getElementById("fileInput").files[0];
  if (!file) { alert("Selecione um .xlsx"); return; }

  const formData = new FormData();
  formData.append("cliente", cliente);
  formData.append("modelo", modelo);
  formData.append("relatorio", file);

  const resp = await fetch("/api/analisar", { method: "POST", body: formData });
  if (!resp.ok) { alert("Falha ao gerar relatório"); return; }

  const blob = await resp.blob();
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = `${cliente || "cliente"}_${modelo || "modelo"}_relatorio.pdf`;
  document.body.appendChild(a);
  a.click();
  a.remove();
  URL.revokeObjectURL(url);
}
</script>


